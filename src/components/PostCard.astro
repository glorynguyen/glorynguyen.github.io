---
// PostCard component for blog index page
// Works with MDX content collection posts

interface Props {
  slug: string;
  pubDate: Date;
  title: string;
  titleVi?: string;
  description: string;
  descriptionVi?: string;
  tags: string[];
}

const { slug, pubDate, title, titleVi, description, descriptionVi, tags } = Astro.props;

// Helper functions for date formatting
const formatDateEn = (date: Date) => {
  return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
};

const formatDateVi = (date: Date) => {
  return date.toLocaleDateString('vi-VN');
};

// Simple tag mapping for Vietnamese
const mapTag = (tag: string): string => {
  const tagMap: Record<string, string> = {
    'AI': 'AI',
    'Open Standards': 'Chuẩn mở',
    'Personal Story': 'Câu chuyện cá nhân',
    'Leadership': 'Lãnh đạo',
    'Engineering': 'Kỹ thuật',
    'Engineering Strategy': 'Chiến lược Kỹ thuật',
    'Career': 'Sự nghiệp',
    'Productivity': 'Năng suất',
    'Future of Work': 'Tương lai công việc',
    'Programming': 'Lập trình',
    'Technology': 'Công nghệ',
    'MCP': 'MCP',
    'GSAP': 'GSAP',
    'Animation': 'Hoạt ảnh',
    'Security': 'Bảo mật',
    'Integration': 'Tích hợp',
    'AI Agent': 'AI Agent',
    'Distributed Teams': 'Đội ngũ phân tán',
    'Architecture': 'Kiến trúc',
    'Product Management': 'Quản lý sản phẩm',
    'Technical Leadership': 'Lãnh đạo kỹ thuật',
    'Performance': 'Hiệu năng',
    'JavaScript': 'JavaScript',
  };
  return tagMap[tag] || tag;
};
---

<a href={`/blog/posts/${slug}.html`} class="post-card">
    <div class="post-meta">
        <span class="post-date">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
            <span data-lang="en">{formatDateEn(pubDate)}</span>
            <span data-lang="vi" hidden>{formatDateVi(pubDate)}</span>
        </span>
        <span class="post-tag" data-lang="en">{tags.join(', ')}</span>
        <span class="post-tag" data-lang="vi" hidden>{tags.map(mapTag).join(', ')}</span>
    </div>

    <h2 class="post-title" data-lang="en">{title}</h2>
    <h2 class="post-title" data-lang="vi" hidden>{titleVi || title}</h2>

    <p class="post-excerpt" data-lang="en">{description}</p>
    <p class="post-excerpt" data-lang="vi" hidden>{descriptionVi || description}</p>

    <span class="read-more" data-lang="en">
        Read more
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
    </span>
    <span class="read-more" data-lang="vi" hidden>
        Đọc tiếp
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
    </span>
</a>
